{% extends "introduction/base.html" %}
{% block content %}
{% block title %}
<title>INJECTION LAB</title>
{% endblock %}

<div class="container">
    <div class="my-blogs">
        <h3>My Blogs</h3>
        <ul class="ssti-ul">
        {% for blog in blogs %}
        <li class="ssti-li" style="color: #626262;">
            <a href=blog/{{blog.blog_id}}>{{blog.blog_id}}</a>
        </li>
        {% endfor %}
        </ul>
    </div>
    <div id="ssti-inner-div2">
        <h3>Add Blog</h3>
        <form method="POST" class="ssti-form">
            {% csrf_token %} 
            <textarea id="ssti_blog" name="blog" placeholder="your blogs goes here" style="background:#f4f4f924;overflow: auto"></textarea>
            <button class="btn btn-info" type="submit" id="inject">POST</button>
        </form>
    </div>
</div>

{% comment %} -------------------------------------------------------------------------- {% endcomment %}

<button class="coll2 btn btn-info" style= "position : fixed ; right :200px; bottom : 7px">View Code</button>
<div class="lab code">
   <code>   
    def ssrf_lab(request):</br>
&emsp;if request.user.is_authenticated:</br>
&emsp;&emsp;if request.method=="GET":</br>
&emsp;&emsp;&emsp;return render(request,"Lab/ssrf/ssrf_lab.html",{"blog":"Read Blog About SSRF"})</br>
&emsp;&emsp;else:</br>
&emsp;&emsp;&emsp;file=request.POST["blog"]</br>
&emsp;&emsp;&emsp;try :</br>
&emsp;&emsp;&emsp;&emsp;dirname = os.path.dirname(__file__)</br>
&emsp;&emsp;&emsp;&emsp;filename = os.path.join(dirname, file)</br>
&emsp;&emsp;&emsp;&emsp;file = open(filename,"r")</br>
&emsp;&emsp;&emsp;&emsp;data = file.read()</br>
&emsp;&emsp;&emsp;&emsp;return render(request,"Lab/ssrf/ssrf_lab.html",{"blog":data})</br>
&emsp;&emsp;&emsp;except:</br>
&emsp;&emsp;&emsp;&emsp;return render(request, "Lab/ssrf/ssrf_lab.html", {"blog": "No blog found"})</br>
&emsp;else:</br>    
&emsp;&emsp;return redirect('login')</br>
   </code>
    
</div>
<div>

<div style= "position : fixed ; right : 7px; bottom : 7px"> <button class="btn btn-info" type="button" onclick="window.location.href='/ssti'">Back to Lab
    Details</button></div>

{% endblock %}